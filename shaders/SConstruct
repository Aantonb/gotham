import os
import glob

bld = Builder(action = 'pbslc $SOURCE')
env = Environment(BUILDERS = {'Material' : bld},
                  suffix = '.so',
                  src_suffix = '.pbsl')

# set GOTHAMHOME in the scons environment
env['ENV']['GOTHAMHOME'] = os.environ['GOTHAMHOME']
# add the bin directory to the path
env['ENV']['PATH'] += ':' + env['ENV']['GOTHAMHOME'] + '/bin'

# find all .pbsls in the current directory
sources = []
pattern = os.path.join(os.getcwd(), "*.pbsl")
for fullpath in glob.glob(pattern):
  basename = os.path.basename(fullpath)
  sources.append(basename)

for s in sources:
  env.Material(s.split('.')[0] + '.so',s)

